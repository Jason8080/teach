#### 01复习Mybatis第2天的内容【了解】

##### 目标

- 回顾Mybatis的常用功能为今天的高级功能打下基础

##### 步骤

###### 面试题

- \#{}与${}的区别是什么 ?

  - **\#{}**是Mybatis框架在映射文件中取值的 **占位符**
  - **${}**是Mybatis框架在映射文件中取值的 **拼接符**
  - **\#{}**获取的值参与预编译效验特殊字符具**有防SQL注入的功能**
  - **${}**获取的值直接拼接在执行语句中**有SQL注入的风险**
  - **\#{}**可以填写 **#{*}** 任何名称获取基本数据类型的参数
  - **\${}**只能填写 **${value}** 来获取基本数据类型的参数

- Mybatis映射文件中如何返回自增长主键值 ?

  - **不支持自增长的数据库** 可以使用 **SelectKey** 标签在 **Insert语句执行后** 执行查询最后主键值的语句并反射到参数对象中的某一个属性

    ```xml
    <selectKey resultType="int" keyColumn="id" keyProperty="id" order="AFTER">
        -- 查询当前连接中最后一个自增长主键值
        select LAST_INSERT_ID()
    </selectKey>
    ```

  - **支持自增长的数据库**  可以在Insert标签中添加**useGeneratedKeys**和**keyProperty**属性达到效果并且本质与<selectKey标签相同

###### 开发形式

- 代理开发
- 传统开发



##### 操作

###### 创建项目

- 接下来学习的是连接池相关内容
- 项目名称: mybatis-day03-pool

###### 引入依赖

- 数据库驱动
- 框架包
- log4j日志依赖包(3个)
- c3p0连接池

###### 引入文件

- java文件
  - User.java
  - UserDao.java
  - UserDaoImpl.java
  - SqlSessionKit.java

- 配置文件

  - mybatis.xml
  - userDao.xml

  - db.properties
  - log4j.properties

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

- mybatis.xml
- userMapper.xml

###### 环境测试

- 创建测试类
- 执行查找操作



##### 小结

- 回顾了第2天的常用标签
- 搭建好传统开发方式的环境
- 搭建Mybatis项目环境的固定步骤



#### 02主配置中数据源类型配置【了解】

##### 目标

- 了解Mybatis连接池3中类型

##### 步骤

- 配置dataSource type=POOLED
  1. 添加测试方法
  2. 执行测试方法
  3. 观察连接对象
- 配置dataSource type=UNPOOLED
  1. 添加测试方法
  2. 执行测试方法
  3. 观察连接对象
- 配置dataSource type=**jndi实现类**
  1. 创建**jndi实现类**
  2. 配置dataSource属性
  3. 添加测试方法
  4. 执行测试方法
  5. 观察连接对象

##### 操作

###### POOLED

- 配置
- 测试

###### UNPOOLED

- 配置
- 测试

###### JNDI

- 创建jndi实现类

- 配置
- 测试

##### 小结

- POOLED采用了框架提供的连接池技术, 连接关闭只是放回连接池
- UNPOOLED不采用连接池, 每次执行都是一个新连接
- JNDI采用外部的连接, 同样达到连接关闭只是放回连接池的效果



#### 03主配置中事务类型配置【了解】

##### 目标

- 了解JDBC事务提交的 **2种** 方式

##### 步骤

###### 两种类型

- JDBC: 使用jdbc的设置管理事务
- MANAGED: 使用外部容器管理事务

###### 两种方式

- 手动提交
- 自动提交

##### 操作

###### 创建模块

###### 引入依赖

###### 引入文件



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



#### 02主配置中数据源类型配置【了解】

##### 目标



##### 步骤



##### 操作



##### 小结



